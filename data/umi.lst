import (
  "src/github.com/midbel/dissect/data/enums.lst"
)

declare (
  coarse: uint 32
  fine  : uint 8
)

block time (
  coarse
  fine
)

block pid (
  dass  : uint 8, DaSS
  orbit : uint 16
  state : uint 16, State
  code  : bytes 6
)

block about (
  type  : uint 8, Type
  unit  : uint 16
)

data(
  size  : uint 32 little

  include pid
  include about
  include time

  length: uint 16

  match type with (
    1 = (
      param as int with 32
    )
    2 = (
      param as float with 64
    )
    3 = (
      param as bytes with length
    )
    4 = (
      param as int with 32
    )
    5 = (
      param as string with length
    )
    6 = (
      param as int with 64
    )
    14 = (
      seek 7
      param: int 1
    )
  )
)
