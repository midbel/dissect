import (
  "src/github.com/midbel/dissect/data/enums.lst"
  "src/github.com/midbel/dissect/data/time.lst"
)

data "var/cdmcs/**/pp/**/*dat" "tmp/*dat" (
  size  : uint 32 little

  dass  : uint 8, DaSS
  orbit : uint 16
  state : uint 16, State
  code  : bytes 6

  type  : uint 8, Type
  unit  : uint 16

  include time5

  length: uint 16
  #let bitlen = length * 8

  match type with (
    1 = (
      param as int with 32
    )
    2 = (
      param as float with 64
    )
    3 = (
      param as bytes with length
    )
    4 = (
      param as int with 32
    )
    5 = (
      param as string with length
    )
    6 = (
      param as int with 64
    )
    14 = (
      seek 7
      param: int 1
    )
  )

  #print <raw|eng|both|debug> to <file> as <csv|table> with <values...>
  print to "umi.csv"
)
