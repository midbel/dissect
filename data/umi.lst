import (
  "src/github.com/midbel/dissect/data/enums.lst"
)

declare (
  coarse: uint 32
  fine  : uint 8
)

block time (
  coarse
  fine
)

block pid (
  dass  : uint 8, DaSS
  orbit : uint 16
  state : uint 16, State
  code  : bytes 48
)

block about (
  type  : uint 8, Type
  unit  : uint 16
)

data(
  size  : uint 32

  include pid
  include about
  include time

  length: uint 16
  #let bits = bytes2bits(length)

  match type with (
    1 = (
      param: int 32
    )
    2 = (
      param: float 64
    )
    3 = (
      param: bytes 64
    )
    4 = (
      param: int 32
    )
    5 = (
      param: string 64
    )
    6 = (
      param: int 64
    )
    14 = (
      seek 7
      param: int 1
    )
  )
)
